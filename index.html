<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags for Character Encoding and Responsive Viewport -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Page Title for Browser Tab and SEO -->
    <title>Cash Treasure - Earn Daily Rewards</title>
    <!-- Font Awesome for Icons in Navigation and Profile -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <!-- EmailJS SDK for Sending Redemption Notifications -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        // Initialize EmailJS with Public Key
        (function() { emailjs.init("hu8ooWZeFEnduWG2Z"); })();
    </script>
    <!-- Firebase SDK for Analytics -->
    <script type="module">
        // Import Firebase App and Analytics
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAnalytics, logEvent } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCHtoRudA31gExVEkzDI_meMgXLI4CJW70",
            authDomain: "cashtreasure-b374e.firebaseapp.com",
            projectId: "cashtreasure-b374e",
            storageBucket: "cashtreasure-b374e.firebasestorage.app",
            messagingSenderId: "133658014711",
            appId: "1:133658014711:web:ca8570483f0f4828cab4f2",
            measurementId: "G-FW1C6XG7QW"
        };
        // Initialize Firebase and Analytics
        const app = initializeApp(firebaseConfig);
        window.analytics = getAnalytics(app);
        window.logEvent = logEvent;
        // Log Initial Page View
        window.logEvent(window.analytics, 'page_view', { page_title: 'Cash Treasure Home' });
    </script>
    <!-- Inline CSS for Comprehensive Styling -->
    <style>
        /* Reset Default Browser Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        /* Base Body Styles */
        body {
            font-family: 'Arial', sans-serif;
            background: #f2f2f2;
            color: #333333;
            line-height: 1.6;
            min-height: 100vh;
        }
        /* Sign-in Mode Styling */
        body.signin-mode {
            background-color: #7CFC00;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: auto;
        }
        /* Container for Forms */
        .container {
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            text-align: center;
            max-width: 400px;
            width: 90%;
            margin: 20px auto;
            position: relative;
        }
        /* Logo Styling for Login Page */
        .logo {
            width: 200px;
            margin: 0 auto 20px;
            display: block;
            border-radius: 10px;
        }
        /* Cash Treasure Title */
        .cash-title {
            font-size: 28px;
            font-weight: 700;
            color: #ff0000;
            margin: 15px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        /* Welcome Message */
        .welcome-msg {
            color: #0000ff;
            font-size: 18px;
            margin-bottom: 25px;
            font-weight: 500;
        }
        /* Success Message Styling */
        #success-message, #login-success-message {
            font-size: 18px;
            color: #008000;
            margin-top: 15px;
            display: none;
            font-weight: 600;
            transition: opacity 0.3s;
        }
        /* Error Message Styling */
        #error-message, #login-error-message {
            font-size: 16px;
            color: #ff0000;
            margin-top: 15px;
            display: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }
        /* Form Styling */
        form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        /* Input Field Styling */
        input {
            padding: 12px;
            font-size: 16px;
            border: 1px solid #cccccc;
            border-radius: 6px;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        input:focus {
            border-color: #8e24aa;
            box-shadow: 0 0 5px rgba(142,36,170,0.3);
        }
        /* General Button Styling */
        button {
            padding: 12px;
            font-size: 16px;
            background-color: #ffd700;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        button:hover {
            background-color: #ffa500;
        }
        button:active {
            transform: scale(0.95);
        }
        /* Purple Button */
        .purple {
            background-color: #8e24aa;
            color: #ffffff;
        }
        .purple:hover {
            background-color: #6a1b9a;
        }
        /* Orange Button */
        .orange {
            background-color: #ff9800;
            color: #ffffff;
        }
        .orange:hover {
            background-color: #f57c00;
        }
        /* Red Button */
        .red {
            background-color: #ff0000;
            color: #ffffff;
        }
        .red:hover {
            background-color: #d32f2f;
        }
        /* Green Button */
        .green {
            background-color: #4caf50;
        }
        .green:hover {
            background-color: #388e3c;
        }
        /* Toggle Button */
        .toggle-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 4px;
        }
        /* Heading Styles */
        h2 {
            font-size: 24px;
            color: #333333;
            margin: 12px 0;
            text-align: center;
        }
        h3 {
            font-size: 20px;
            color: #333333;
            margin: 12px 0;
            text-align: center;
        }
        h4 {
            font-size: 18px;
            color: #333333;
            margin: 10px 0;
            text-align: center;
        }
        /* Section Styling */
        .section {
            display: none;
            padding: 20px;
            margin-bottom: 70px;
        }
        .section.active {
            display: block;
        }
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            display: flex;
            justify-content: space-around;
            background: #ffffff;
            border-top: 1px solid #e0e0e0;
            padding: 8px 0;
            z-index: 1000;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
        }
        .bottom-nav button {
            flex: 1;
            padding: 8px;
            border: none;
            background: #006400;
            border: 1px solid #dddddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            color: #ffffff;
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        .bottom-nav button:hover {
            background: #004d00;
        }
        .bottom-nav .redeem-btn {
            transform: scale(1.2);
            border: 4px solid transparent;
            border-image: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet) 1;
        }
        .bottom-nav i {
            font-size: 22px;
            display: block;
            margin-bottom: 4px;
        }
        .bottom-nav .redeem-btn i {
            font-size: 26px;
        }
        /* Section Buttons */
        .button {
            width: 100%;
            margin: 10px 0;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            color: #ffffff;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        .button:hover {
            transform: scale(1.02);
        }
        /* Redeem Button Colors */
        .amazon {
            background-color: #ff0000;
        }
        .amazon:hover {
            background-color: #d32f2f;
        }
        .flipkart {
            background-color: #ff9800;
        }
        .flipkart:hover {
            background-color: #f57c00;
        }
        .google {
            background-color: #4caf50;
        }
        .google:hover {
            background-color: #388e3c;
        }
        /* Green Card Button */
        .green-card-button {
            background: linear-gradient(45deg, #ffd700, #ffa500);
            color: #000000;
            border-radius: 12px;
            padding: 14px;
            font-size: 18px;
            margin: 10px 0;
            border: none;
            cursor: pointer;
            width: 100%;
        }
        .green-card-button:hover {
            background: linear-gradient(45deg, #ffca28, #ff8f00);
        }
        /* Redeem Card */
        .redeem-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #ffffff;
            margin: 10px 0;
            padding: 14px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .redeem-btn {
            background-color: #8e24aa;
            color: #ffffff;
            border: none;
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 6px;
            cursor: pointer;
        }
        .redeem-btn:hover {
            background-color: #6a1b9a;
        }
        /* Daily Check-in */
        .checkin-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #007bff;
            padding: 16px;
            border-radius: 10px;
            color: #ffffff;
            font-size: 18px;
            max-width: 400px;
            margin: 20px auto;
        }
        .claim-btn {
            background-color: #ffd700;
            color: #000000;
            border: none;
            padding: 10px 20px;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
        }
        .claim-btn:disabled {
            background-color: #bbbbbb;
            cursor: not-allowed;
        }
        /* Messages */
        .info, .message, #checkin-message, #ads-message, #more-ads-message {
            text-align: center;
            margin-top: 16px;
            font-size: 16px;
            font-weight: bold;
        }
        /* Points Display */
        #pointDisplay {
            position: fixed;
            top: 12px;
            right: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #000000;
            z-index: 1001;
        }
        /* History Buttons */
        .history-btn {
            width: 100%;
            padding: 14px;
            margin: 10px 0;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: #ffffff;
        }
        .redeem-history-btn {
            background-color: #ff0000;
        }
        .redeem-history-btn:hover {
            background-color: #d32f2f;
        }
        .point-history-btn {
            background-color: #007bff;
        }
        .point-history-btn:hover {
            background-color: #005cb2;
        }
        /* History Log */
        .history-log {
            background: #ffffff;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .green-text {
            color: #008000;
        }
        .red-text {
            color: #ff0000;
        }
        /* Flip Card */
        .card-container {
            perspective: 1000px;
            margin: 20px auto;
            width: 100%;
            max-width: 300px;
        }
        .card {
            width: 100%;
            height: 180px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s ease;
        }
        .card.flipped {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 22px;
            font-weight: bold;
            text-align: center;
            padding: 12px;
        }
        .card-front {
            background: linear-gradient(45deg, #ffd700, #ffc107);
            color: #000000;
        }
        .card-front::before {
            content: "LUCKY CARD";
        }
        .card-back {
            background-color: #ffff00;
            color: #000000;
            transform: rotateY(180deg);
            flex-direction: column;
        }
        .flip-btn {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #ffd700, #ffa500);
            color: #000000;
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            z-index: 2;
        }
        .flip-btn:disabled {
            background-color: #aaaaaa;
            cursor: not-allowed;
        }
        /* Confetti Animation */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #ff0000;
            opacity: 0.8;
            animation: fall 3s linear forwards;
        }
        @keyframes fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        /* Quiz Container */
        #quiz-container {
            max-width: 400px;
            margin: 20px auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        #quizQuestion {
            font-size: 24px;
            margin: 15px 0;
            color: #333333;
            text-align: center;
        }
        #quizOptions button {
            display: block;
            width: 100%;
            margin: 8px 0;
            padding: 12px;
            font-size: 18px;
            border: none;
            border-radius: 6px;
            color: #ffffff;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        #quizOptions button:hover {
            transform: scale(1.02);
        }
        /* Quiz Option Colors */
        .yellow {
            background-color: #fdd835;
        }
        .yellow:hover {
            background-color: #fbc02d;
        }
        .green {
            background-color: #43a047;
        }
        .green:hover {
            background-color: #388e3c;
        }
        .purple {
            background-color: #8e24aa;
        }
        .purple:hover {
            background-color: #6a1b9a;
        }
        .blue {
            background-color: #1e88e5;
        }
        .blue:hover {
            background-color: #1565c0;
        }
        /* Quiz Feedback */
        #quizFeedback {
            font-size: 18px;
            margin: 15px 0;
            font-weight: bold;
            text-align: center;
        }
        /* Claim Quiz Points */
        #claimQuizBtn {
            display: none;
            margin: 15px auto;
            padding: 12px 24px;
            background-color: #ffeb3b;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
        }
        /* Quiz Message */
        #quizMessage {
            font-size: 16px;
            color: #ff0000;
            margin-top: 10px;
            text-align: center;
        }
        /* Flips and Ads Indicators */
        #flipsLeft, #adsLeft, #moreAdsLeft {
            text-align: center;
            margin: 12px 0;
            font-weight: bold;
            font-size: 16px;
        }
        /* Home Button */
        #homeBtn {
            background-color: #007bff;
            color: #ffffff;
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
        }
        #homeBtn:hover {
            background-color: #005cb2;
        }
        /* Earn Message */
        .earn-message {
            textAPR-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #ff9800;
            text-transform: uppercase;
            margin: 12px 0;
        }
        /* Profile Button */
        .profile-btn {
            position: fixed;
            top: 12px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #ffa500);
            border: 2px solid #ffffff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
        }
        .profile-btn i {
            font-size: 24px;
            color: #ffffff;
        }
        /* Modal Styling */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1002;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 24px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            position: relative;
        }
        .close {
            position: absolute;
            top: 12px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #333333;
        }
        .profile-info {
            margin: 12px 0;
            font-size: 18px;
            font-weight: bold;
        }
        /* Message Container for Gift Card Notifications */
        .message-container {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            z-index: 1004;
            text-align: center;
        }
        /* Gift Card Messages */
        #giftCardMessage {
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            transition: opacity 0.3s;
        }
        .message-success {
            background-color: #4caf50;
            color: #ffffff;
        }
        .message-error {
            background-color: #ff0000;
            color: #ffffff;
        }
        /* Utility Classes */
        .text-center { text-align: center; }
        .mt-10 { margin-top: 10px; }
        .mb-10 { margin-bottom: 10px; }
        .p-10 { padding: 10px; }
        .bold { font-weight: bold; }
        .uppercase { text-transform: uppercase; }
        .hidden { display: none; }
        /* Responsive Design */
        @media (max-width: 480px) {
            .container {
                padding: 20px;
                width: 95%;
            }
            .cash-title {
                font-size: 24px;
            }
            .welcome-msg {
                font-size: 16px;
            }
            .logo {
                width: 150px;
            }
            #quizQuestion {
                font-size: 20px;
            }
            #quizOptions button {
                font-size: 16px;
                padding: 10px;
            }
            .checkin-container {
                flex-direction: column;
                gap: 10px;
                padding: 12px;
            }
            .bottom-nav button {
                font-size: 12px;
                padding: 6px;
            }
            .bottom-nav i {
                font-size: 18px;
            }
            .profile-btn {
                width: 40px;
                height: 40px;
            }
            .profile-btn i {
                font-size: 20px;
            }
            #pointDisplay {
                font-size: 16px;
                top: 10px;
                right: 10px;
            }
        }
        @media (max-width: 360px) {
            .cash-title {
                font-size: 20px;
            }
            .welcome-msg {
                font-size: 14px;
            }
            .logo {
                width: 120px;
            }
            input {
                font-size: 14px;
                padding: 10px;
            }
            button {
                font-size: 14px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Gift Card Message Container -->
    <div class="message-container">
        <div id="giftCardMessage" style="display: none;"></div>
    </div>

    <!-- Sign-in Container -->
    <div id="signin-container">
        <div class="container">
            <!-- Toggle to Login -->
            <button id="toggleLoginBtn" class="purple toggle-btn" onclick="showLoginForm()">Login</button>
            <!-- Title -->
            <p class="cash-title">CASH TREASURE</p>
            <!-- Welcome Message -->
            <p class="welcome-msg">WELCOME TO CASH TREASURE</p>
            <!-- Sign-up Form -->
            <form id="signup-form" onsubmit="sendEmail(event)">
                <input type="text" id="firstName" placeholder="First Name" required>
                <input type="text" id="lastName" placeholder="Last Name" required>
                <input type="email" id="email" placeholder="Gmail" required>
                <input type="password" id="password" placeholder="Create a Password" required>
                <button type="submit">Sign Up</button>
            </form>
            <!-- Success Message -->
            <p id="success-message">YOU HAVE BEEN SUCCESSFULLY SIGNED IN😊</p>
            <!-- Error Message -->
            <p id="error-message"></p>
        </div>
    </div>

    <!-- Login Container -->
    <div id="login-container" style="display: none;">
        <div class="container">
            <!-- Logo -->
            <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCI..." alt="Cash Treasure Logo" class="logo">
            <!-- Toggle to Sign-up -->
            <button id="toggleSignupBtn" class="purple toggle-btn" onclick="showSignupForm()">Sign Up</button>
            <!-- Title -->
            <p class="cash-title">CASH TREASURE</p>
            <!-- Login Prompt -->
            <p class="welcome-msg">LOGIN TO CASH TREASURE</p>
            <!-- Login Form -->
            <form id="login-form" onsubmit="loginUser(event)">
                <input type="email" id=" conceptloginEmail" placeholder="Enter Gmail" required>
                <input type="password" id="loginPassword" placeholder="Enter Password" required>
                <button type="submit" class="purple">Login</button>
            </form>
            <!-- Success Message -->
            <p id="login-success-message">YOU HAVE BEEN SUCCESSFULLY LOGGED IN</p>
            <!-- Error Message -->
            <p id="login-error-message"></p>
        </div>
    </div>

    <!-- Main Content -->
    <div id="main-content" style="display: none;">
        <!-- Points Display -->
        <div id="pointDisplay">💰 <span id="totalPointsHeader">0</span></div>
        <!-- Home Section -->
        <div id="home" class="section active">
            <!-- Profile Button -->
            <button id="profileBtn" class="profile-btn" onclick="showProfileModal()"><i class="fas fa-user"></i></button>
            <!-- Home Content -->
            <div id="home-main">
                <h3>DAILY REWARDS</h3>
                <div class="earn-message">EARN UPTO 1200 POINTS DAILY</div>
                <!-- Daily Check-in -->
                <div class="checkin-container">
                    <div>Daily Check-In</div>
                    <button id="claimBtn" class="claim-btn">CLAIM</button>
                </div>
                <div id="checkin-message"></div>
                <!-- Standard Ads -->
                <div id="adsLeft">Ads left to watch today: 50</div>
                <button id="watchAdsBtn" class="button green" onclick="watchAds()">Watch Ads</button>
                <div id="ads-message"></div>
                <!-- More Ads -->
                <div id="moreAdsLeft">More ads left to watch today: 10</div>
                <button id="watchMoreAdsBtn" class="button orange" onclick="watchMoreAds()">Watch More Ads</button>
                <div id="more-ads-message"></div>
                <!-- Flip Card -->
                <button class="green-card-button" onclick="toggleFlipCard()">Try Your Luck (Flip Card)</button>
                <div id="flipCardWrapper" style="display:none;">
                    <div id="flipsLeft">Flips left today: 10</div>
                    <div class="card-container">
                        <div class="card" id="flipCard">
                            <div class="card-face card-front"></div>
                            <div class="card-face card-back" id="cardBackText"></div>
                            <button class="flip-btn" id="flipBtn">FLIP NOW</button>
                        </div>
                    </div>
                    <div class="message" id="message"></div>
                </div>
                <!-- Quiz Button -->
                <button class="button purple" onclick="showQuiz()">Earn by Answering</button>
            </div>
            <!-- Quiz Section -->
            <div id="quiz-section" style="display: none;">
                <h2>Answer and Earn</h2>
                <div id="quiz-container">
                    <div id="quizQuestionCounter"></div>
                    <div id="quizQuestion"></div>
                    <div id="quizOptions"></div>
                    <div id="quizFeedback"></div>
                    <button id="claimQuizBtn">CLAIM YOUR POINTS</button>
                    <div id="quizMessage"></div>
                </div>
                <button id="homeBtn" onclick="hideQuiz()">HOME</button>
            </div>
        </div>
        <!-- Redeem Section -->
        <div id="redeem" class="section">
            <h3>Redeem Your Points</h3>
            <button class="button amazon" onclick="showSection('amazon')">Amazon Pay Gift Card</button>
            <button class="button flipkart" onclick="showSection('flipkart')">Flipkart Gift Card</button>
            <button class="button google" onclick="showSection('google')">Google Play Gift Card</button>
            <div id="redeemSection"></div>
            <div class="info">You will receive reward within 24 hours in your Gmail</div>
        </div>
        <!-- Wallet Section -->
        <div id="wallet" class="section">
            <h3>Wallet</h3>
            <button class="history-btn redeem-history-btn" onclick="showRedeemHistory()">REDEEM HISTORY</button>
            <button class="history-btn point-history-btn" onclick="showPointHistory()">POINT HISTORY</button>
            <div id="historyOutput"></div>
        </div>
        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button onclick="switchTab('home')"><i class="fas fa-home"></i><div>Home</div></button>
            <button class="redeem-btn" onclick="switchTab('redeem')"><i class="fas fa-gift"></i><div>Redeem</div></button>
            <button onclick="switchTab('wallet')"><i class="fas fa-wallet"></i><div>Wallet</div></button>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span id="closeModal" class="close">×</span>
            <h3>User Profile</h3>
            <div id="userPoints" class="profile-info"></div>
            <div id="userName" class="profile-info"></div>
            <div id="userEmail" class="profile-info"></div>
            <button id="logoutBtn" class="orange" onclick="showLogoutConfirmation()">Logout</button>
            <p id="logoutConfirmation" style="display: none;">ARE YOU SURE YOU WANT TO LOGOUT🥺</p>
            <button id="confirmLogoutBtn" class="red" style="display: none;" onclick="confirmLogout()">Yes</button>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        // ---------------- Utility Functions ----------------

        // Show Element for a Duration
        function showElementForDuration(elementId, duration) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            return new Promise(resolve => {
                setTimeout(() => {
                    element.style.display = 'none';
                    resolve();
                }, duration);
            });
        }

        // Show Gift Card Message
        function showGiftCardMessage(message, isSuccess) {
            const messageEl = document.getElementById('giftCardMessage');
            messageEl.textContent = message;
            messageEl.className = isSuccess ? 'message-success' : 'message-error';
            messageEl.style.display = 'block';
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }

        // ---------------- Authentication Functions ----------------

        // Initialize Page
        window.addEventListener("load", () => {
            if (localStorage.getItem("signedIn") === "true") {
                document.getElementById("signin-container").style.display = "none";
                document.getElementById("login-container").style.display = "none";
                document.getElementById("main-content").style.display = "block";
            } else {
                document.getElementById("signin-container").style.display = "block";
                document.getElementById("login-container").style.display = "none";
                document.body.classList.add("signin-mode");
            }
            updatePointsDisplay();
        });

        // Show Login Form
        function showLoginForm() {
            document.getElementById("signin-container").style.display = "none";
            document.getElementById("login-container").style.display = "block";
            logEvent(analytics, 'view_login_form');
        }

        // Show Sign-up Form
        function showSignupForm() {
            document.getElementById("login-container").style.display = "none";
            document.getElementById("signin-container").style.display = "block";
            logEvent(analytics, 'view_signup_form');
        }

        // Handle Sign-up
        async function sendEmail(event) {
            event.preventDefault();
            const firstName = document.getElementById("firstName").value.trim();
            const lastName = document.getElementById("lastName").value.trim();
            const email = document.getElementById("email").value.trim();
            const password = document.getElementById("password").value.trim();

            // Validate Inputs
            if (!firstName || !lastName || !email || !password) {
                showError("Please fill in all fields.");
                return;
            }

            // Validate Email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showError("Please enter a valid email address.");
                return;
            }

            // Clear Messages
            document.getElementById("success-message").style.display = "none";
            document.getElementById("error-message").style.display = "none";

            // Store User Data
            localStorage.setItem("userName", firstName + " " + lastName);
            localStorage.setItem("userEmail", email);
            localStorage.setItem("userPassword", password);
            localStorage.setItem("signedIn", "true");

            // Show Success Message
            await showElementForDuration("success-message", 1000);

            // Transition to Main Content
            document.getElementById("signin-container").style.display = "none";
            document.getElementById("main-content").style.display = "block";
            document.body.classList.remove("signin-mode");
            logEvent(analytics, 'signup_success');
        }

        // Handle Login
        async function loginUser(event) {
            event.preventDefault();
            const email = document.getElementById("loginEmail").value.trim();
            const password = document.getElementById("loginPassword").value.trim();
            const storedEmail = localStorage.getItem("userEmail");
            const storedPassword = localStorage.getItem("userPassword");

            // Clear Messages
            document.getElementById("login-success-message").style.display = "none";
            document.getElementById("login-error-message").style.display = "none";

            // Validate Inputs
            if (!email || !password) {
                showLoginError("Please enter both email and password.");
                return;
            }

            // Verify Credentials
            if (email === storedEmail && password === storedPassword) {
                localStorage.setItem("signedIn", "true");
                await showElementForDuration("login-success-message", 1000);
                document.getElementById("login-container").style.display = "none";
                document.getElementById("main-content").style.display = "block";
                document.body.classList.remove("signin-mode");
                logEvent(analytics, 'login_success');
            } else {
                showLoginError("Invalid email or password.");
            }
        }

        // Show Sign-up Error
        function showError(message) {
            const errorMessage = document.getElementById("error-message");
            errorMessage.textContent = message;
            errorMessage.style.display = "block";
        }

        // Show Login Error
        function showLoginError(message) {
            const loginErrorMessage = document.getElementById("login-error-message");
            loginErrorMessage.textContent = message;
            loginErrorMessage.style.display = "block";
        }

        // ---------------- Core State ----------------

        // Points
        let totalPoints = parseInt(localStorage.getItem("dailyPoints") || "0");
        const today = new Date().toISOString().split("T")[0];

        // Daily Check-in
        const lastClaimed = localStorage.getItem("dailyCheckin");
        const claimBtn = document.getElementById("claimBtn");
        const checkinMessageDiv = document.getElementById("checkin-message");

        // Gift Cards
        const giftCards = {
            amazon: [
                { points: 1050, amount: "20" },
                { points: 2000, amount: "40" },
                { points: 4750, amount: "100" }
            ],
            flipkart: [
                { points: 1050, amount: "20" },
                { points: 2400, amount: "50" },
                { points: 4750, amount: "100" }
            ],
            google: [
                { points: 550, amount: "10" },
                { points: 1500, amount: "30" },
                { points: 4000, amount: "80" },
                { points: 10000, amount: "240" }
            ]
        };

        // History
        const pointHistory = JSON.parse(localStorage.getItem("pointHistory") || "[]");
        const redeemHistory = JSON.parse(localStorage.getItem("redeemHistory") || "[]");

        // ---------------- Ad Watching ----------------

        // Standard Ads (50/day, 10 points)
        let adWatchData = JSON.parse(localStorage.getItem("adWatchData") || "{}");
        if (adWatchData.date !== today) {
            adWatchData = { date: today, count: 0 };
            localStorage.setItem("adWatchData", JSON.stringify(adWatchData));
        }
        const adsLeftEl = document.getElementById("adsLeft");
        adsLeftEl.textContent = `Ads left to watch today: ${50 - adWatchData.count}`;
        const watchAdsBtn = document.getElementById("watchAdsBtn");
        const adsMessageDiv = document.getElementById("ads-message");
        if (adWatchData.count >= 50) {
            watchAdsBtn.disabled = true;
            adsMessageDiv.style.color = "red";
            adsMessageDiv.textContent = "You have reached the daily limit of watching ads, come tomorrow!";
        }

        // More Ads (10/day, 13 points)
        let moreAdWatchData = JSON.parse(localStorage.getItem("moreAdWatchData") || "{}");
        if (moreAdWatchData.date !== today) {
            moreAdWatchData = { date: today, count: 0 };
            localStorage.setItem("moreAdWatchData", JSON.stringify(moreAdWatchData));
        }
        const moreAdsLeftEl = document.getElementById("moreAdsLeft");
        moreAdsLeftEl.textContent = `More ads left to watch today: ${10 - moreAdWatchData.count}`;
        const watchMoreAdsBtn = document.getElementById("watchMoreAdsBtn");
        const moreAdsMessageDiv = document.getElementById("more-ads-message");
        if (moreAdWatchData.count >= 10) {
            watchMoreAdsBtn.disabled = true;
            moreAdsMessageDiv.style.color = "red";
            moreAdsMessageDiv.textContent = "YOU REACHED THE DAILY LIMIT OF WATCHING ADS 🥺 COME TOMORROW!";
        }

        // Update Points
        function updatePointsDisplay() {
            document.getElementById("totalPointsHeader").textContent = totalPoints;
            localStorage.setItem("dailyPoints", totalPoints);
        }

        // Watch Standard Ads
        async function watchAds() {
            if (adWatchData.count < 50) {
                totalPoints += 10;
                adWatchData.count += 1;
                localStorage.setItem("adWatchData", JSON.stringify(adWatchData));
                adsLeftEl.textContent = `Ads left to watch today: ${50 - adWatchData.count}`;
                adsMessageDiv.style.color = "green";
                adsMessageDiv.textContent = "You earned 10 points for watching ads!";
                pointHistory.push({ type: "add", reason: "Watched Ad", amount: 10, date: today });
                localStorage.setItem("pointHistory", JSON.stringify(pointHistory));
                updatePointsDisplay();
                if (adWatchData.count >= 50) {
                    watchAdsBtn.disabled = true;
                    adsMessageDiv.style.color = "red";
                    adsMessageDiv.textContent = "You have reached the daily limit of watching ads, come tomorrow!";
                }
                logEvent(analytics, 'ad_watched', { points_earned: 10, ad_type: 'standard' });
            }
        }

        // Watch More Ads
        async function watchMoreAds() {
            if (moreAdWatchData.count < 10) {
                totalPoints += 13;
                moreAdWatchData.count += 1;
                localStorage.setItem("moreAdWatchData", JSON.stringify(moreAdWatchData));
                moreAdsLeftEl.textContent = `More ads left to watch today: ${10 - moreAdWatchData.count}`;
                moreAdsMessageDiv.style.color = "green";
                moreAdsMessageDiv.textContent = "YOU EARNED 13 POINTS BY WATCHING ADS🤑";
                pointHistory.push({ type: "add", reason: "Watched More Ad", amount: 13, date: today });
                localStorage.setItem("pointHistory", JSON.stringify(pointHistory));
                updatePointsDisplay();
                if (moreAdWatchData.count >= 10) {
                    watchMoreAdsBtn.disabled = true;
                    moreAdsMessageDiv.style.color = "red";
                    moreAdsMessageDiv.textContent = "YOU REACHED THE DAILY LIMIT OF WATCHING ADS 🥺 COME TOMORROW!";
                }
                logEvent(analytics, 'ad_watched', { points_earned: 13, ad_type: 'more' });
            }
        }

        // ---------------- Daily Check-in ----------------

        // Check Status
        if (lastClaimed === today) {
            claimBtn.disabled = true;
            checkinMessageDiv.textContent = "You already checked in today. Come back tomorrow!";
        }

        // Handle Check-in
        claimBtn.addEventListener("click", async () => {
            const rand = Math.random() * 100;
            let points = rand <= 2 ? Math.floor(Math.random() * 5) + 16 :
                         rand <= 90 ? Math.floor(Math.random() * 8) + 1 :
                         Math.floor(Math.random() * 8) + 8;
            totalPoints += points;
            pointHistory.push({ type: "add", reason: "Daily Check-in", amount: points, date: today });
            localStorage.setItem("pointHistory", JSON.stringify(pointHistory));
            claimBtn.disabled = true;
            localStorage.setItem("dailyCheckin", today);
            checkinMessageDiv.textContent = `You received ${points} points today!`;
            updatePointsDisplay();
            logEvent(analytics, 'daily_checkin', { points_earned: points });
        });

        // ---------------- Flip Card ----------------

        // Initialize Flip Data
        let flipData = JSON.parse(localStorage.getItem("flipData") || "{}");
        if (flipData.date !== today) {
            flipData = { date: today, count: 0 };
            localStorage.setItem("flipData", JSON.stringify(flipData));
        }
        const flipsLeftEl = document.getElementById("flipsLeft");
        flipsLeftEl.textContent = `Flips left today: ${10 - flipData.count}`;
        const flipBtn = document.getElementById("flipBtn");
        const card = document.getElementById("flipCard");
        const backText = document.getElementById("cardBackText");
        const flipMessageDiv = document.getElementById("message");
        if (flipData.count >= 10) {
            flipBtn.disabled = true;
            flipMessageDiv.innerText = "Daily chances to flip the card reached, come tomorrow!";
            flipMessageDiv.style.color = "red";
        }

        // Toggle Flip Card
        function toggleFlipCard() {
            const wrapper = document.getElementById("flipCardWrapper");
            wrapper.style.display = wrapper.style.display === "none" ? "block" : "none";
            logEvent(analytics, 'toggle_flip_card');
        }

        // Handle Flip
        flipBtn.addEventListener("click", async () => {
            if (flipData.count < 10 && !card.classList.contains("flipped")) {
                const rand = Math.random() * 100;
                let points = rand <= 80 ? Math.floor(Math.random() * 8) + 1 :
                             rand <= 95 ? Math.floor(Math.random() * 7) + 8 :
                             rand <= 98 ? Math.floor(Math.random() * 6) + 15 :
                             Math.floor(Math.random() * 11) + 20;
                totalPoints += points;
                backText.innerHTML = `YOU WON ${points} POINTS!`;
                pointHistory.push({ type: "add", reason: "Flip Card", amount: points, date: today });
                localStorage.setItem("pointHistory", JSON.stringify(pointHistory));
                card.classList.add("flipped");
                flipData.count += 1;
                localStorage.setItem("flipData", JSON.stringify(flipData));
                flipsLeftEl.textContent = `Flips left today: ${10 - flipData.count}`;
                updatePointsDisplay();
                // Confetti
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement("div");
                    confetti.classList.add("confetti");
                    confetti.style.left = Math.random() * 100 + "vw";
                    confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    confetti.style.animationDuration = 2 + Math.random() * 2 + "s";
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 4000);
                }
                setTimeout(() => {
                    card.classList.remove("flipped");
                    if (flipData.count >= 10) {
                        flipBtn.disabled = true;
                        flipMessageDiv.innerText = "Daily chances to flip the card reached, come tomorrow!";
                        flipMessageDiv.style.color = "red";
                    }
                }, 3000);
                logEvent(analytics, 'flip_card', { points_earned: points });
            }
        });

        // ---------------- Quiz Feature ----------------

        // Quiz Questions (200 Questions)
        const quizQuestions = [
            ["1 + 4", 5], ["2 + 4", 6], ["3 + 2", 5], ["2 + 1", 3], ["4 + 5", 9], ["5 + 3", 8], ["1 + 1", 2], ["5 + 2", 7],
            ["8 + 1", 9], ["7 + 6", 13], ["5 + 5", 10], ["4 + 3", 7], ["2 + 3", 5], ["4 + 4", 8], ["3 + 5", 8], ["3 + 2", 5],
            ["1 + 3", 4], ["4 + 2", 6], ["3 + 3", 6], ["2 + 2", 4], ["1 + 4", 5], ["5 + 1", 6], ["4 + 3", 7], ["3 + 4", 7],
            ["9 + 0", 9], ["0 + 6", 6], ["7 + 0", 7], ["4 + 5", 9], ["3 + 3", 6], ["2 + 0", 2], ["1 + 0", 1], ["4 + 0", 4],
            ["5 + 0", 5], ["6 + 0", 6], ["7 + 2", 9], ["6 + 3", 9], ["7 + 3", 10], ["5 + 2", 7], ["5 + 1", 6], ["4 + 5", 9],
            ["5 + 4", 9], ["8 + 2", 10], ["2 + 5", 7], ["4 + 8", 12], ["5 + 3", 8], ["8 + 0", 8], ["9 - 0", 9], ["1 - 0", 1],
            ["2 - 0", 2], ["3 - 0", 3], ["4 - 0", 4], ["5 - 0", 5], ["6 - 0", 6], ["7 - 0", 7], ["8 - 0", 8], ["0 + 0", 0],
            ["0 - 0", 0], ["0 × 0", 0], ["2 + 4", 6], ["1 - 1", 0], ["2 - 3", -1], ["3 - 3", 0], ["4 - 3", 1], ["4 - 5", -1],
            ["6 - 5", 1], ["7 - 6", 1], ["8 - 6", 2], ["9 - 7", 2], ["0 - 6", -6], ["7 - 8", -1], ["8 - 5", 3], ["9 - 3", 6],
            ["8 - 5", 3], ["7 - 6", 1], ["3 - 2", 1], ["3 - 6", -3], ["7 - 2", 5], ["8 - 4", 4], ["3 - 0", 3], ["9 + 3", 12],
            ["7 - 3", 4], ["8 - 5", 3], ["9 - 0", 9], ["4 + 5", 9], ["6 + 2", 8], ["3 - 7", -4], ["5 - 7", -2], ["4 - 8", -4],
            ["6 - 9", -3], ["4 - 3", 1], ["3 - 2", 1], ["7 - 4", 3], ["8 - 7", 1], ["9 - 8", 1], ["7 - 5", 2], ["7 - 2", 5],
            ["10 - 5", 5], ["6 + 4", 10], ["8 - 3", 5], ["9 - 4", 5], ["5 + 6", 11], ["7 + 4", 11], ["8 + 3", 11], ["9 + 2", 11],
            ["10 - 2", 8], ["11 - 3", 8], ["12 - 4", 8], ["6 + 3", 9], ["7 + 5", 12], ["8 + 4", 12], ["9 + 1", 10], ["10 + 0", 10],
            ["11 - 1", 10], ["12 - 2", 10], ["5 × 2", 10], ["4 × 3", 12], ["3 × 4", 12], ["2 × 5", 10], ["6 ÷ 2", 3], ["8 ÷ 4", 2],
            ["10 ÷ 5", 2], ["12 ÷ 3", 4], ["15 ÷ 5", 3], ["9 ÷ 3", 3], ["6 × 2", 12], ["5 × 3", 15], ["4 × 4", 16], ["3 × 5", 15],
            ["2 × 6", 12], ["7 × 2", 14], ["8 × 2", 16], ["9 × 1", 9], ["10 ÷ 2", 5], ["12 ÷ 4", 3], ["14 ÷ 2", 7], ["16 ÷ 4", 4],
            ["18 ÷ 3", 6], ["20 ÷ 5", 4], ["6 + 6", 12], ["7 + 7", 14], ["8 + 8", 16], ["9 + 9", 18], ["10 - 6", 4], ["11 - 5", 6],
            ["12 - 6", 6], ["13 - 7", 6], ["14 - 8", 6], ["15 - 9", 6], ["3 × 3", 9], ["4 × 2", 8], ["5 × 4", 20], ["6 × 3", 18],
            ["7 × 1", 7], ["8 ÷ 2", 4], ["9 ÷ 1", 9], ["10 × 1", 10], ["11 + 2", 13], ["12 + 3", 15], ["13 - 4", 9], ["14 - 5", 9],
            ["15 ÷ 3", 5], ["16 ÷ 2", 8], ["17 - 8", 9], ["18 - 9", 9], ["19 - 10", 9], ["20 - 11", 9], ["2 × 7", 14], ["3 × 6", 18],
            ["4 × 5", 20], ["5 × 5", 25], ["6 × 4", 24], ["7 × 3", 21], ["8 × 3", 24], ["9 × 2", 18], ["10 ÷ 4", 2.5], ["12 ÷ 6", 2],
            ["13 + 2", 15], ["14 + 3", 17], ["15 - 6", 9], ["16 - 7", 9], ["17 + 1", 18], ["18 - 2", 16], ["19 - 3", 16], ["20 - 4", 16],
            ["2 × 8", 16], ["3 × 7", 21], ["4 × 6", 24], ["5 × 6", 30], ["6 × 5", 30], ["7 × 4", 28], ["8 × 4", 32], ["9 × 3", 27],
            ["10 × 2", 20], ["11 × 1", 11], ["12 ÷ 2", 6], ["14 ÷ 7", 2], ["16 ÷ 8", 2], ["18 ÷ 6", 3], ["20 ÷ 4", 5], ["22 ÷ 11", 2],
            ["24 ÷ 6", 4], ["25 ÷ 5", 5], ["15 + 5", 20], ["16 + 4", 20], ["17 + 3", 20], ["18 + 2", 20], ["19 + 1", 20], ["20 - 5", 15],
            ["21 - 6", 15], ["22 - 7", 15], ["23 - 8", 15], ["24 - 9", 15], ["25 - 10", 15], ["3 × 8", 24], ["4 × 7", 28], ["5 × 7", 35],
            ["6 × 6", 36], ["7 × 5", 35], ["8 × 5", 40], ["9 × 4", 36], ["10 × 3", 30], ["11 × 2", 22], ["12 × 2", 24], ["15 ÷ 3", 5],
            ["20 ÷ 4", 5], ["25 ÷ 5", 5], ["30 ÷ 6", 5], ["35 ÷ 7", 5], ["40 ÷ 8", 5], ["45 ÷ 9", 5], ["50 ÷ 10", 5], ["12 + 8", 20],
            ["13 + 7", 20], ["14 + 6", 20], ["15 + 5", 20], ["16 + 4", 20], ["17 + 3", 20], ["18 + 2", 20], ["19 + 1", 20], ["20 - 5", 15]
        ];

        // Quiz State
        let quizCurrentAnswer = null;
        let quizQuestionCount = 0;
        const maxQuizQuestions = 32;
        const quizQuestionEl = document.getElementById("quizQuestion");
        const quizOptionsEl = document.getElementById("quizOptions");
        const quizFeedbackEl = document.getElementById("quizFeedback");
        const claimQuizBtn = document.getElementById("claimQuizBtn");
        const quizMessageEl = document.getElementById("quizMessage");
        const quizCounterEl = document.getElementById("quizQuestionCounter");

        // Quiz Tracking
        let quizLastDate = localStorage.getItem("quizLastDate") || "";
        let quizQuestionsToday = parseInt(localStorage.getItem("quizQuestionsToday") || "0");

        if (quizLastDate !== today) {
            quizQuestionsToday = 0;
            localStorage.setItem("quizLastDate", today);
            localStorage.setItem("quizQuestionsToday", "0");
        }

        // Show Quiz
        function showQuiz() {
            if (quizQuestionsToday >= maxQuizQuestions) {
                quizMessageEl.textContent = "DAILY CHANCES TO EARN POINTS REACHED, COME TOMORROW";
                document.getElementById('home-main').style.display = 'none';
                document.getElementById('quiz-section').style.display = 'block';
                return;
            }
            document.getElementById('home-main').style.display = 'none';
            document.getElementById('quiz-section').style.display = 'block';
            askQuizQuestion();
            logEvent(analytics, 'quiz_started');
        }

        // Hide Quiz
        function hideQuiz() {
            document.getElementById('quiz-section').style.display = 'none';
            document.getElementById('home-main').style.display = 'block';
            logEvent(analytics, 'quiz_exited');
        }

        // Get Random Question
        function getRandomQuizQuestion() {
            return quizQuestions[Math.floor(Math.random() * quizQuestions.length)];
        }

        // Generate Options
        function generateQuizOptions(correct) {
            const options = new Set();
            options.add(correct);
            while (options.size < 4) {
                const wrong = correct + Math.floor(Math.random() * 11) - 5;
                options.add(wrong);
            }
            return Array.from(options).sort(() => Math.random() - 0.5);
        }

        // Ask Question
        function askQuizQuestion() {
            if (quizQuestionsToday >= maxQuizQuestions) {
                quizQuestionEl.textContent = "";
                quizOptionsEl.innerHTML = "";
                quizFeedbackEl.textContent = "";
                claimQuizBtn.style.display = "none";
                quizMessageEl.textContent = "DAILY CHANCES TO EARN POINTS REACHED, COME TOMORROW";
                return;
            }
            quizFeedbackEl.textContent = "";
            quizMessageEl.textContent = "";
            claimQuizBtn.style.display = "none";
            quizCounterEl.textContent = `Question ${quizQuestionCount + 1} of ${maxQuizQuestions}`;
            const [expr, answer] = getRandomQuizQuestion();
            quizCurrentAnswer = answer;
            quizQuestionEl.textContent = expr;
            const colors = ["yellow", "green", "purple", "blue"];
            const opts = generateQuizOptions(answer);
            quizOptionsEl.innerHTML = "";
            opts.forEach((opt, index) => {
                const btn = document.createElement("button");
                btn.textContent = opt;
                btn.className = colors[index % 4];
                btn.onclick = () => handleQuizAnswer(opt);
                quizOptionsEl.appendChild(btn);
            });
        }

        // Handle Quiz Answer
        function handleQuizAnswer(selected) {
            if (quizQuestionsToday >= maxQuizQuestions) {
                quizMessageEl.textContent = "DAILY CHANCES TO EARN POINTS REACHED, COME TOMORROW";
                return;
            }
            if (selected === quizCurrentAnswer) {
                quizFeedbackEl.textContent = "CORRECT ✅";
                claimQuizBtn.style.display = "inline-block";
            } else {
                quizFeedbackEl.textContent = "WRONG ❌ TRY AGAIN";
                quizQuestionCount++;
                quizQuestionsToday++;
                localStorage.setItem("quizQuestionsToday", quizQuestionsToday);
                setTimeout(askQuizQuestion, 1000);
            }
            logEvent(analytics, 'quiz_answer', { correct: selected === quizCurrentAnswer });
        }

        // Claim Quiz Points
        claimQuizBtn.onclick = () => {
            totalPoints += 12;
            updatePointsDisplay();
            pointHistory.push({ type: "add", reason: "Quiz Answer", amount: 12, date: today });
            localStorage.setItem("pointHistory", JSON.stringify(pointHistory));
            claimQuizBtn.style.display = "none";
            quizQuestionCount++;
            quizQuestionsToday++;
            localStorage.setItem("quizQuestionsToday", quizQuestionsToday);
            askQuizQuestion();
            logEvent(analytics, 'quiz_points_claimed', { points_earned: 12 });
        };

        // ---------------- Redeem Feature ----------------

        // Redeem Gift Card
        function redeem(requiredPoints) {
            if (totalPoints >= requiredPoints) {
                totalPoints -= requiredPoints;
                showGiftCardMessage("SUCCESSFULLY REDEEMED", true);
                const giftLabel = findGiftLabel(requiredPoints);
                redeemHistory.push({
                    amount: requiredPoints,
                    date: new Date().toLocaleString(),
                    label: giftLabel
                });
                pointHistory.push({ type: "deduct", reason: "Redeem", amount: requiredPoints, date: today });
                localStorage.setItem("redeemHistory", JSON.stringify(redeemHistory));
                localStorage.setItem("pointHistory", JSON.stringify(pointHistory));
                const userEmail = localStorage.getItem("userEmail") || "unknown@example.com";
                const giftCardType = giftLabel.split(" ")[2];
                const params = {
                    user_email: userEmail,
                    gift_card_type: giftCardType,
                    points_redeemed: requiredPoints,
                    amount: giftLabel.match(/₹\d+/)?.[0] || "Unknown",
                    redemption_date: new Date().toLocaleString()
                };
                emailjs.send("service_ocajjyg", "template_zr07mmn", params)
                    .then(() => console.log("Redemption notification sent successfully!"),
                         (error) => console.error("Failed to send redemption notification:", error));
                logEvent(analytics, 'gift_card_redeemed', { gift_card_type: giftCardType, points_redeemed: requiredPoints });
            } else {
                showGiftCardMessage("YOU DON'T HAVE ENOUGH POINTS TO REDEEM THIS GIFT CARD", false);
            }
            updatePointsDisplay();
        }

        // Find Gift Label
        function findGiftLabel(points) {
            for (let key in giftCards) {
                const found = giftCards[key].find(c => c.points === points);
                if (found) return `₹${found.amount} of ${capitalize(key).toUpperCase()} GIFT CARD of points ${points}😊`;
            }
            return `Gift Card of ${points} points😊`;
        }

        // Show Gift Cards
        function showSection(type) {
            const section = document.getElementById('redeemSection');
            let html = `<h4>${capitalize(type)} Gift Cards</h4>`;
            giftCards[type].forEach(card => {
                html += `<div class="redeem-card"><span>${card.points} points = ₹${card.amount}</span><button class="redeem-btn" onclick="redeem(${card.points})">REDEEM</button></div>`;
            });
            section.innerHTML = html;
            logEvent(analytics, 'view_gift_cards', { card_type: type });
        }

        // ---------------- Navigation and History ----------------

        // Switch Tabs
        function switchTab(tab) {
            document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
            document.getElementById(tab).classList.add("active");
            logEvent(analytics, 'tab_switch', { tab_name: tab });
        }

        // Show Redeem History
        function showRedeemHistory() {
            const out = document.getElementById("historyOutput");
            if (!redeemHistory.length) {
                out.innerHTML = `<div class="info">YOU DON'T REDEEM YET</div>`;
                return;
            }
            out.innerHTML = redeemHistory.map(r => `<div class="history-log">${r.label} (${r.date})</div>`).join("");
            logEvent(analytics, 'view_redeem_history');
        }

        // Show Point History
        function showPointHistory() {
            const out = document.getElementById("historyOutput");
            if (!pointHistory.length) {
                out.innerHTML = `<div class="info">No point history yet</div>`;
                return;
            }
            out.innerHTML = pointHistory.map(p => {
                const color = p.type === "add" ? "green-text" : "red-text";
                const symbol = p.type === "add" ? `+${p.amount} points` : `-${p.amount} points`;
                return `<div class="history-log ${color}">${symbol} (${p.reason}, ${p.date})</div>`;
            }).join("");
            logEvent(analytics, 'view_point_history');
        }

        // Capitalize
        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // ---------------- Profile and Logout ----------------

        // Show Profile
        function showProfileModal() {
            const userName = localStorage.getItem("userName") || "Guest";
            const userEmail = localStorage.getItem("userEmail") || "Not provided";
            document.getElementById("userPoints").innerHTML = `💰 ${totalPoints}`;
            document.getElementById("userPoints").style.color = "red";
            document.getElementById("userName").innerHTML = userName;
            document.getElementById("userName").style.color = "green";
            document.getElementById("userEmail").innerHTML = userEmail;
            document.getElementById("userEmail").style.color = "#FFD700";
            document.getElementById("profileModal").style.display = "flex";
            document.getElementById("logoutConfirmation").style.display = "none";
            document.getElementById("confirmLogoutBtn").style.display = "none";
            logEvent(analytics, 'profile_view');
        }

        // Show Logout Prompt
        function showLogoutConfirmation() {
            document.getElementById("logoutConfirmation").style.display = "block";
            document.getElementById("confirmLogoutBtn").style.display = "block";
            logEvent(analytics, 'logout_prompt');
        }

        // Confirm Logout
        function confirmLogout() {
            localStorage.removeItem("signedIn");
            localStorage.removeItem("userName");
            localStorage.removeItem("userEmail");
            localStorage.removeItem("userPassword");
            localStorage.removeItem("dailyPoints");
            localStorage.removeItem("pointHistory");
            localStorage.removeItem("redeemHistory");
            localStorage.removeItem("flipData");
            localStorage.removeItem("adWatchData");
            localStorage.removeItem("moreAdWatchData");
            localStorage.removeItem("quizLastDate");
            localStorage.removeItem("quizQuestionsToday");
            window.location.reload();
            logEvent(analytics, 'logout');
        }

        // Close Modal
        document.getElementById("closeModal").addEventListener("click", () => {
            document.getElementById("profileModal").style.display = "none";
        });

        // Close Modal on Outside Click
        window.addEventListener("click", (event) => {
            if (event.target === document.getElementById("profileModal")) {
                document.getElementById("profileModal").style.display = "none";
            }
        });

        // Initial Update
        updatePointsDisplay();
    </script>
</body>
</html>